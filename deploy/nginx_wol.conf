# Example nginx config to proxy to Gunicorn socket (safe default: HTTP only)
server {
    listen 80;
    server_name _;

    # Proxy to the runtime socket created by systemd: /run/wakeonlan/wakeonlan.sock
    # Ensure the socket is readable by the nginx group (www-data) via RuntimeDirectoryMode and UMask in the service.
    location / {
        include proxy_params;
        proxy_pass http://unix:/run/wakeonlan/wakeonlan.sock;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_http_version 1.1;
        proxy_set_header Connection "";
    }

    # Optional: serve static files (adjust path if needed)
    location /static/ {
        alias /home/wol/Wake-on-lan/static/;
        access_log off;
        expires 30d;
    }
}

# === SSL (example) ===
# The following SSL server block is provided as an example. Do NOT enable it as-is
# because it references certificate files that do not exist until you obtain them
# from Let's Encrypt (certbot). To enable TLS, obtain certificates first and then
# create a separate server block that listens on 443 and uses the correct paths.
# Example to obtain certificates:
#   sudo certbot --nginx -d your.domain.example
# After certbot creates the files under /etc/letsencrypt/live/your.domain.example/,
# you can create a server block like this (adjust server_name and cert paths):
#
# server {
#     listen 443 ssl;
#     server_name your.domain.example;
#     ssl_certificate /etc/letsencrypt/live/your.domain.example/fullchain.pem;
#     ssl_certificate_key /etc/letsencrypt/live/your.domain.example/privkey.pem;
#
#     location / {
#         include proxy_params;
#         proxy_pass http://unix:/run/wakeonlan/wakeonlan.sock;
#     }
# }
#
# If you want automatic redirection http->https, certbot can modify your site for you.
